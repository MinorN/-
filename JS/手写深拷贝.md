# 手写深拷贝

## 方法一：使用`JSON`

```js
const b = JSON.parse(JSON.stringify(a))
```

缺点：

1. 不支持`Date`、正则、`undefined`、函数等数据；
2. 不支持引用；

## 方法二：用递归

```js
const deepClone = (a，cache) => {
  if(!cache){
      cache = new Map() // 为什么用Map？因为key是对象，object的key是string或symbol
  }
  if(chache.get(a)){
      return cache.get(a)
  }
  // 先判断是哪一种
  if (a instanceof Object) {
    let result = undefined;
    // object
    if (a instanceof Function) {
      if (a.prototype) {
        // 普通函数
        result = function () {
          return a.apply(this, arguments);
        };
      } else {
        // 箭头函数
        result = (...argus) => {
          return a.call(undefined, ...argus);
        };
      }
    } else if (a instanceof Array) {
      result = [];
    } else if (a instanceof Date) {
      result = new Date(a - 0); // 使用时间戳
    } else if (a instanceof RegExp) {
      result = new RegExp(a.souce, a.flags);
    } else {
      result = {};
    }
    cache.set(a,result)
    for (let key in a) {
      if(a.hasOwnProperty(key)){
         result[key] = deepClone(a[key],cache);         
      }
    }
    return result;
  } else {
    // string number bool bigint null undefined symbol
     return a;
  }
};
```

关键点：

1. 递归
2. 判断类型
3. 检查是否有环
4. 不拷贝原型上的属性